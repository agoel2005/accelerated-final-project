=================================================
Optimized Attention Kernel for Large Dimensions
Target: hdim = 2048, 4096, 8192
=================================================

*** Testing hdim=512 ***

========================================
Testing LARGE DIM attention kernel:
  Batch size: 1
  Num heads: 4
  Sequence length: 64
  Head dimension: 512
========================================

Running optimized kernel for large dimensions...
Running CPU reference...

--- Performance Results ---
Optimized kernel time: 0.044 ms
Performance: 0.76 TFLOPS

Checking results vs CPU...
  Max difference: 0.000000 (within tolerance 0.050000)

✓ TEST PASSED

*** Testing hdim=2048 ***

========================================
Testing LARGE DIM attention kernel:
  Batch size: 1
  Num heads: 4
  Sequence length: 64
  Head dimension: 2048
========================================

Running optimized kernel for large dimensions...
Running CPU reference...

--- Performance Results ---
Optimized kernel time: 0.163 ms
Performance: 0.82 TFLOPS

Checking results vs CPU...
  Max difference: 0.000000 (within tolerance 0.050000)

✓ TEST PASSED

*** Testing hdim=4096 ***

========================================
Testing LARGE DIM attention kernel:
  Batch size: 1
  Num heads: 2
  Sequence length: 32
  Head dimension: 4096
========================================

Running optimized kernel for large dimensions...
Running CPU reference...

--- Performance Results ---
Optimized kernel time: 0.124 ms
Performance: 0.27 TFLOPS

Checking results vs CPU...
  Max difference: 0.000000 (within tolerance 0.050000)

✓ TEST PASSED

*** Testing hdim=8192 ***

========================================
Testing LARGE DIM attention kernel:
  Batch size: 1
  Num heads: 1
  Sequence length: 16
  Head dimension: 8192
========================================

Running optimized kernel for large dimensions...
Running CPU reference...

--- Performance Results ---
Optimized kernel time: 0.184 ms
Performance: 0.05 TFLOPS

Checking results vs CPU...
  Max difference: 0.000000 (within tolerance 0.050000)

✓ TEST PASSED

*** Testing EXTREME hdim=16384 ***

========================================
Testing LARGE DIM attention kernel:
  Batch size: 1
  Num heads: 1
  Sequence length: 8
  Head dimension: 16384
========================================

Running optimized kernel for large dimensions...
Running CPU reference...

--- Performance Results ---
Optimized kernel time: 0.336 ms
Performance: 0.01 TFLOPS

Checking results vs CPU...
  Max difference: 0.000001 (within tolerance 0.050000)

✓ TEST PASSED

=================================================
All tests completed!
=================================================
